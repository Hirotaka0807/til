# TOC
- [TOC](#toc)
- [目次](#目次)
  - [はじめに](#はじめに)
  - [第一部 表面上の改善](#第一部-表面上の改善)
  - [第二部 ループとロジックの単純化](#第二部-ループとロジックの単純化)
  - [第三部 コードの再構成](#第三部-コードの再構成)
  - [第四部 選抜テーマ](#第四部-選抜テーマ)
  - [解説](#解説)
- [要約](#要約)
  - [はじめに](#はじめに-1)
    - [1. 理解しやすいコード](#1-理解しやすいコード)
  - [第一部 表面上の改善](#第一部-表面上の改善-1)
    - [2. 名前に情報を詰め込む](#2-名前に情報を詰め込む)
    - [3. 誤解されない名前](#3-誤解されない名前)
    - [4. 美しさ](#4-美しさ)
    - [5. コメントすべきことを知る](#5-コメントすべきことを知る)
    - [6. コメントは正確で簡潔に](#6-コメントは正確で簡潔に)
  - [第二部 ループとロジックの単純化](#第二部-ループとロジックの単純化-1)
    - [7. 制御フローを読みやすくする](#7-制御フローを読みやすくする)
    - [8. 巨大な式を分割する](#8-巨大な式を分割する)
    - [9. 変数と読みやすさ](#9-変数と読みやすさ)
# 目次
## はじめに
1. 理解しやすいコード
## 第一部 表面上の改善
2. 名前に情報を詰め込む
3. 誤解されない名前
4. 美しさ
5. コメントすべきことを知る
6. コメントは正確で簡潔に
## 第二部 ループとロジックの単純化
7. 制御フローを読みやすくする
8. 巨大な式を分割する
9. 変数と読みやすさ
## 第三部 コードの再構成
10. 無関係の会問題を抽出する
11. 一度に1つのことを
12. コードに思いを込める
13. 短いコードを書く
## 第四部 選抜テーマ
14. テストと読みやすさ
15. 「分／時間カウンタ」を設計・実装する
## 解説
- 実際にやる
- 当たり前にする
- コードで伝える

# 要約
## はじめに
### 1. 理解しやすいコード
- コードは理解しやすくなければならない
    - 理解しやすいコードは、変更を加えたり、バグを見つけたり、他のコードと連携しやすくなったりとメリットが多い
    - 仮に自分しか読まない（と思っている）コードでも、半年後の自分はコードを書いた時の自分とは違う。
- 読みやすさの基本定理
    - **コードは他の人が最短時間で理解できるように書かなければならない。**

## 第一部 表面上の改善
適切に名前を選ぶ、優れたコメントを書く、コードを綺麗にフォーマットするなどの「表面上」の改善は**コードの全てに影響する**ため、個々の影響は小さくともコードに大きな改善をもたらすことができる。

### 2. 名前に情報を詰め込む
- **名前に情報を詰め込む**
  - 名前は短いコメントだと考える。よい名前は、短くても多くの情報を伝えることができる。

- 意識すること
  - 明確な単語を選ぶ
    - get, makeなど抽象的な単語はできるだけ使わない。
    - より情報量が多い単語（get > download, create, make> create, compose）などを使う。
    - 単語が思いつかない場合、シソーラス（類語辞典）が便利。
    - ただし、気取りすぎて何を言っているかわからない単語を使わないようにすること。

  - 汎用的な名前を避ける（または使う状況を選ぶ）
    - tmp, fooなど、何の情報も持たない単語を使わない。
    - ただし、「その変数は後の処理では全く使わない」という意味を込めたい時には使っても良い。
      - 何を一時的に保管しているのか、データの型は何かなど盛り込むべき情報はあることが多そうなので、基本は使わないと考えても良さそう。

  - 抽象的な名前よりも具体的な名前を使う
    - できるだけ具体的かつ、余計な情報が含まれないような名前をつける。
    - **その場の感情、状況を一旦差し置いて、その関数（変数）が持つ働きのみに注目して命名する。**
  - 接尾辞や接頭辞を使って情報を追加する
    - 単位を接尾辞として追加する
      - startではなく、start_second, start_dateなど
    - 重要な属性を追加する
      - train済みのmodelはtrained_modelとか、変換されていないyはunformatted_yとか。
  - 名前の長さを決める
    - 名前の長さは、その変数のスコープの大きさに比例させる。
      - 関数内だけなら1文字でも可、外部から呼び出すメンバ変数とかなら情報多めに。
    - **名前が長いこと自体は悪いことではない。** 単語補完があるのでタイピングは簡単。原則にあった命名を優先させよう。
    - **新しいチームメンバーが理解できない省略形は使わない。**
  - 名前のフォーマットで情報を伝える
    - メンバ変数にはアンダースコアをつけ、ローカル変数と区別するなど。
      - グローバルは大文字とかですね...あんまり理解できていない。また質問しよう。

### 3. 誤解されない名前
- **名前が「他の意味と間違えられないだろうか」と何度も自問自答する。**
  - コードを理解しやすくするには、情報量を増やすだけではなく、情報が読み手に正しく伝達されるかにも気を配る必要がある。

- 意識すること
  - 例：filter
    - filter: フィルタをかけて中身を「選択」したのか「除外」したのかわからない。
      - 選択ならselect, 除外ならexcludeなど適切な単語がある。
  - 値の境界を指定するときに気を配ること
    - 限界値を含めるときは、min, maxを使う。
      - too_bigとかだとその値を含むかがわからない。
    - 範囲を指定するときは、first, lastを使う。
      - こちらもstart, stopだと曖昧。
    - ブール値
      - 頭にis, can, has, shouldなどをつけて分かりやすくする。
      - 否定形を使わない。

### 4. 美しさ
- formatterである程度解決するので、一旦飛ばし読み。
### 5. コメントすべきことを知る
- **コメントの目的は、書き手の意図を読み手に知らせることである**
  - コメントには、単にコードの動作を説明する以上の意味がある。
- 意識すること
  - コメントすべきではないこと
    - **コードから「すぐに」わかることは、コメントには書かない**
    - 関数の挙動がわかりづらいときは、まず名前を再検討してみる。
  - コメントすべきこと
    - 自分の考えをコメントに残す
      - 監督のコメンタリーをイメージする。
        - 「ここはこう考えてこういう仕様にしたんだよねえ...」
        - 「時間があればここはこうしたかったよ...」的な。
      - TODO: FIXME: HACK: XXX:などを活用する
      - 定数にコメントをつける
        - この時間に収まるように、学習にかける時間は500秒にしています~的な。
    - ハマりそうな罠について事前に書いておく
      - なぜ？？やこの方が良くない？？に対する説明
    - docstringはきちんと残す
    - ライターズブロックを乗り越えるために
      - コーディング中、思ったことをコメンタリーっぽくそのまま書いてみる
      - それを適宜修正してコメントとして残す
### 6. コメントは正確で簡潔に
- **コメントは領域に対する情報の比率が高くなるように書く**
- 意識すること
  - とにかく正確に、簡潔に
  - 曖昧な代名詞を避ける
  - 必要があれば実例をつけておく
  - コードの意図は、具体レベルではなく抽象レベルで書く
    - 「listをソートする」ではなく、「学習のために特徴量の昇順で並べる」とか？
      - そんな必要がある予測器はなさそうだけど


## 第二部 ループとロジックの単純化
複雑なループ、巨大な式、膨大な変数は認知負荷を大きくしてしまう。
コードの「精神的な荷物」を減らすことで、バグを見つけやすく、コードを変更しやすく、コードに触れることが楽しくなるようにする。

### 7. 制御フローを読みやすくする
- **できるだけ「自然」な制御フローを書く**
- 意識すること
  - if/elseブロックの書き方
    - 条件式は肯定文を用いる
    - 単純な条件から先に書く
      - 最後のelseには条件を書き込む必要がないため、できるだけ複雑なものを残した方が良い
    - 関心のある条件から先に書く
  - **行数よりも、認知にかかる時間を短くする**
  - ネストをできるだけ浅くする
    - 早めにreturnを返すようにする
    - ガード節（関数の上部で単純な条件を先に処理する）を用いるとよい
### 8. 巨大な式を分割する
- **巨大な式は飲み込みやすい大きさに分割する**
- 意識すること
  - 関数の意味を説明する変数を作る
  - 関数の結果を要約した変数を作る
    - 例：user_owns_doc = (request.userid == document.userid)
  - **「スマートな」コードに気をつける。自己満足でスピードバンプを作っているかも** 
### 9. 変数と読みやすさ
- **変数はできる限り少なくする**
- 意識すること
  - 邪魔な変数は削除する
  - 変数のスコープはできるだけ小さくする
  - 変数には一度だけ値を書き込むようにする
